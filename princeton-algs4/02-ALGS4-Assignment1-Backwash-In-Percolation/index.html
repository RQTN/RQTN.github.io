<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Assignment1 - Backwash In Percolation | RQTN</title><meta name="author" content="RQTN"><meta name="copyright" content="RQTN"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Assignment1 - backwash in Percolation 作业网站：Assignment1-Percolation，包含本次作业的说明，FAQ，相关的有用资源文件。  backwash 问题在作业网站的 FAQ 中提到了一个叫做 backwash 的问题：  Q: After the system has percolated, my PercolationVisualizer">
<meta property="og:type" content="article">
<meta property="og:title" content="Assignment1 - Backwash In Percolation">
<meta property="og:url" content="http://example.com/princeton-algs4/02-ALGS4-Assignment1-Backwash-In-Percolation/index.html">
<meta property="og:site_name" content="RQTN">
<meta property="og:description" content="Assignment1 - backwash in Percolation 作业网站：Assignment1-Percolation，包含本次作业的说明，FAQ，相关的有用资源文件。  backwash 问题在作业网站的 FAQ 中提到了一个叫做 backwash 的问题：  Q: After the system has percolated, my PercolationVisualizer">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/avatar.jpg">
<meta property="article:published_time" content="2019-08-11T08:29:55.000Z">
<meta property="article:modified_time" content="2024-04-01T00:30:09.628Z">
<meta property="article:author" content="RQTN">
<meta property="article:tag" content="princeton-algs4">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/avatar.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/princeton-algs4/02-ALGS4-Assignment1-Backwash-In-Percolation/index.html"><link rel="preconnect" href="//unpkg.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://unpkg.com/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://unpkg.com/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":100,"languages":{"author":"作者: RQTN","link":"链接: ","source":"来源: RQTN","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://unpkg.com/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Assignment1 - Backwash In Percolation',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-04-01 08:30:09'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.1.1"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">63</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">36</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">17</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/index_img_cut.png')"><nav id="nav"><span id="blog-info"><a href="/" title="RQTN"><span class="site-name">RQTN</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Assignment1 - Backwash In Percolation</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">发表于</span><time datetime="2019-08-11T08:29:55.000Z" title="发表于 2019-08-11 16:29:55">2019-08-11</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Data-Structure-Algorithm/">Data Structure &amp; Algorithm</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">2.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>12分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Assignment1 - Backwash In Percolation"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="Assignment1-backwash-in-Percolation"><a href="#Assignment1-backwash-in-Percolation" class="headerlink" title="Assignment1 - backwash in Percolation"></a>Assignment1 - backwash in Percolation</h2><blockquote>
<p>作业网站：<a target="_blank" rel="noopener" href="https://coursera.cs.princeton.edu/algs4/assignments/percolation/specification.php">Assignment1-Percolation</a>，包含本次作业的说明，FAQ，相关的有用资源文件。</p>
</blockquote>
<h3 id="backwash-问题"><a href="#backwash-问题" class="headerlink" title="backwash 问题"></a>backwash 问题</h3><p>在作业网站的 <a target="_blank" rel="noopener" href="https://coursera.cs.princeton.edu/algs4/assignments/percolation/faq.php">FAQ</a> 中提到了一个叫做 backwash 的问题：</p>
<blockquote>
<p><strong>Q</strong>: After the system has percolated, my <code>PercolationVisualizer</code> colors in light blue all sites connected to open sites on the bottom (in addition to those connected to open sites on the top). Is this “backwash” acceptable?</p>
<p><strong>A</strong>: No, this is likely a bug in <code>Percolation</code>. It is only a minor deduction (because it impacts only the visualizer and not the experiment to estimate the percolation threshold), so don’t go crazy trying to get this detail. However, many students consider this to be the most challenging and creative part of the assignment (especially if you limit yourself to one union–find object).</p>
<p><img src="/img/princeton-algs4/percolation-backwash.png"></p>
</blockquote>
<p>正如上面的回答所说的，backwash 并不会影响到我们最终使用蒙特卡洛模拟所得到的结果 <code>p*</code> 的准确性，但 backwash 确实反映了所设计的 <code>Percolation</code> 是有 Bug 的。</p>
<p>在回答中，实际上已经<del>暗示</del>明示了你一种解决方案：especially if you limit yourself to one union–find object。</p>
<p>下面我们将介绍 4 中解决方案，其中方法 4 是我最后提交的答案，它是方法 1 和方法 3 的结合再改进。</p>
<h3 id="解决-backwash-的方法"><a href="#解决-backwash-的方法" class="headerlink" title="解决 backwash 的方法"></a>解决 backwash 的方法</h3><p>backwash 为什么会发生呢？搞清楚这个问题是解决 backwash 现象的关键。问题的答案是，<strong>backwash 现象是虚拟底部节点 <code>virtualBottom</code> 带来的</strong>。</p>
<p>为了能够快速判断 Percolation System（渗滤系统）是否是渗滤的，我们引入了虚拟顶部节点 <code>virtualTop</code> 和虚拟底部节点 <code>virtualBottom</code>。每次系统顶端的节点开启，就将其与 <code>virtualTop</code> 进行 <code>union</code>，每次系统底端的节点开启，就将其与 <code>virtualBottom</code> 进行 <code>union</code>。这样我们只需要判断 <code>virtualTop</code> 和 <code>virtualBottom</code> 是否 <code>connected</code>，就能知道系统是否是渗滤的。</p>
<p>引入虚拟节点的做法无疑要比“对于每个系统顶端节点判断其是否和底端某个节点 <code>connected</code> ”要高效的多。但同时它也带来了 backwash 问题。</p>
<p>那我们能否尝试只引入 <code>virtualTop</code> 呢？</p>
<p><strong>方法 1：只使用 <code>virtualTop</code></strong></p>
<p>如果只使用虚拟顶部节点的话，要判断一个系统是否是渗滤的，我们就得对该虚拟顶部节点，判断其是否和底端某个节点 <code>connected</code>。这种方法是 $O(n)$ 的，相比“对于每个系统顶端节点判断其是否和底端某个节点 <code>connected</code> ”的 $O(n^2)$，要好了一些，但还可以继续改进。</p>
<p><strong>方法 2：使用两个 <code>WeightedQuickUnionUF</code></strong></p>
<p>这种方法也即 FAQ 中回答里面提示的方法。我们使用两个 <code>WeightedQuickUnionUF</code>：<code>WQUUF1</code> 和 <code>WQUUF2</code>。</p>
<p><code>WQQUF1</code> 带有 <code>virtualTop</code> 和 <code>virtualBottom</code>，其用于判断系统是否渗滤。</p>
<p><code>WQQUF2</code> 只带有 <code>virtualTop</code> ，其用于处理 backwash 现象。</p>
<p><code>WQQUF1</code> 和 <code>WQQUF2</code> 从头到尾执行几乎一样的 <code>union</code> 操作。</p>
<p>这种方法是不难想到的，但 <code>union</code> 操作本身是比较费时的，仅为了处理反洗现象，我们把相同的 <code>union</code> 操作执行了两次，似乎有点不那么优雅。</p>
<p><strong>方法 3：既不使用 <code>virtualTop</code> 也不使用 <code>virtualBottom</code>，对每个节点维护两个属性 <code>connectTop</code> 和 <code>connectBottom</code></strong></p>
<p>该方法是我在网上找到的，在评估中能得到 💯 + Bonus。</p>
<p>这种方法的思想是，对于每次 <code>union(p, q)</code> 操作，我们都去检查：</p>
<ul>
<li><p><code>connectTop</code>：</p>
<ul>
<li><code>p</code> 所在的树（连通分量）的根节点是否其 <code>connectTop</code> 为 true。</li>
<li><code>q</code> 所在的树（连通分量）的根节点是否其 <code>connectTop</code> 为 true。</li>
</ul>
<p>但凡有一个为 true，那么两颗树（两个连通分量）合并以后，新树的根节点其 <code>connectTop</code> 也设为 true。可以看出，如果我们要判断一个节点是否和最顶行相连，只需要找到该节点所在的树的根节点，判断其根节点的 <code>connectTop</code> 属性是否为真即可，为真这说明该节点与最顶行相连，为假则不相连。</p>
</li>
<li><p><code>connectBottom</code>：</p>
<ul>
<li><code>p</code> 所在的树（连通分量）的根节点是否其 <code>connectBottom</code> 为 true。</li>
<li><code>q</code> 所在的树（连通分量）的根节点是否其 <code>connectBottom</code> 为 true。</li>
</ul>
<p>但凡有一个为 true，那么两颗树（两个连通分量）合并以后，新树的根节点其 <code>connectBottom</code> 也设为 true。可以看出，如果我们要判断一个节点是否和最底行相连，只需要找到该节点所在的树的根节点，判断其根节点的 <code>connectBottom</code> 属性是否为真即可，为真这说明该节点与最底行相连，为假则不相连。</p>
</li>
</ul>
<p>我们能看出来 <code>connectTop</code> 以及 <code>connectBottom</code> 属性的传播性，true 最开始是从哪来的呢？如果一个节点被打开，且发现该节点为最顶行的节点，那么其 <code>connectTop</code> 就会被设为 true；如果一个节点被打开，且发现该节点为最底行的节点，那么其 <code>connectTop</code> 就会被设为 true。</p>
<p>这种方法是如何判断系统是否渗滤的呢？它维护了一个实例变量 <code>percolateFlag</code> ，每次 <code>open</code> 打开一个节点，我们都要将该节点与多个其他节点尝试进行 <code>union</code> 并配置 <code>union</code> 后所得新树的根节点的 <code>connectTop</code> 与 <code>connectBottom</code> 属性，我们在这些操作都完成以后，检查是新树的根节点 <code>connectTop</code> 与 <code>connectBottom</code> 是否都为 true，若是这系统渗滤，否则不渗滤。</p>
<p>方法 3 的完整代码见最后。</p>
<p><strong>方法 4：结合方法 1 与方法 3，只使用 <code>virtualTop</code> 且对每个节点只维护属性 <code>connectBottom</code></strong></p>
<p>方法 3 似乎也不那么优雅，它虽然能取得 💯+ Bonus，但有点复杂。</p>
<p>引入虚拟节点是很好的思想，我们知道 backwash 现象是由 <code>virtualBottom</code> 造成的，那么结合方法 3，我们是否可以保留 <code>virtualTop</code> 并对节点维护属性 <code>connectBottom</code> 呢？这就是方法 4。</p>
<p>对于 <code>connectBottom</code> 的维护依然和方法 3 差不多，但引入虚拟节点使得代码简洁了非常多：</p>
<ul>
<li>我们不需要再维护 <code>connectTop</code> 了，要知道，<code>connectTop</code> 和 <code>connectBottom</code> 其实是意义相近的两个概念，维护一个就够呛了，现在少一个就少了很多维护的代码（少了很多 <code>union</code> 和 <code>find</code> 操作）。更重要地，我们还省下了创建 <code>connectTop[]</code> 数组的空间！相当于方法 4 所占用的空间是方法 3 的 2/3。</li>
<li>判断系统是否渗滤也变得非常简单，我们只需要判断 <code>virtualTop</code> 所在的树的根节点其 <code>connectBottom</code> 属性是否是 true 的！</li>
</ul>
<p>方法 4 的完整代码见最后。</p>
<p><strong>效果对比</strong></p>
<div class="table-container">
<table>
<thead>
<tr>
<th>方法 3</th>
<th>方法 4</th>
</tr>
</thead>
<tbody>
<tr>
<td><img src='/img/princeton-algs4/percolation-memory-method3.png'></td>
<td><img src='/img/princeton-algs4/percolation-memory-method4.png'></td>
</tr>
<tr>
<td><img src='/img/princeton-algs4/Timing Percolation method3.png'></td>
<td><img src='/img/princeton-algs4/Timing Percolation method4.png'></td>
</tr>
<tr>
<td><img src='/img/princeton-algs4/union ops method3.png'></td>
<td><img src='/img/princeton-algs4/union ops method4.png'></td>
</tr>
</tbody>
</table>
</div>
<h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><p><strong>方法 3</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> assignment1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> edu.princeton.cs.algs4.WeightedQuickUnionUF;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Percolation</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span>[] site;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span>[] connectTop;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span>[] connectBottom;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span> size;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">numberOfOpenSites</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> WeightedQuickUnionUF uf;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="variable">percolateFlag</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Percolation</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">        validate(n);</span><br><span class="line">        <span class="built_in">this</span>.size = n;</span><br><span class="line">        <span class="built_in">this</span>.uf = <span class="keyword">new</span> <span class="title class_">WeightedQuickUnionUF</span>(n * n);</span><br><span class="line">        <span class="built_in">this</span>.site = <span class="keyword">new</span> <span class="title class_">boolean</span>[n * n];</span><br><span class="line">        <span class="built_in">this</span>.connectTop = <span class="keyword">new</span> <span class="title class_">boolean</span>[n * n];</span><br><span class="line">        <span class="built_in">this</span>.connectBottom = <span class="keyword">new</span> <span class="title class_">boolean</span>[n * n];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">open</span><span class="params">(<span class="type">int</span> row, <span class="type">int</span> col)</span> &#123;</span><br><span class="line">        validate(row, col);</span><br><span class="line">        <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> xyTo1D(row, col);</span><br><span class="line">        <span class="keyword">if</span> (!site[index]) &#123;</span><br><span class="line">            site[index] = <span class="literal">true</span>;</span><br><span class="line">            numberOfOpenSites++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">topFlag</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">bottomFlag</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (row == <span class="number">1</span>) &#123;</span><br><span class="line">            topFlag = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (row == size) &#123;</span><br><span class="line">            bottomFlag = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// Optimize if already connected to top/bottom with short-circuit evaluation</span></span><br><span class="line">        <span class="comment">// connect with down site</span></span><br><span class="line">        <span class="keyword">if</span> (row &lt; size &amp;&amp; site[index + size]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!topFlag &amp;&amp; connectTop[uf.find(index + size)] || connectTop[uf.find(index)]) &#123;</span><br><span class="line">                topFlag = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (connectBottom[uf.find(index + size)] || connectBottom[uf.find(index)]) &#123;</span><br><span class="line">                bottomFlag = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            uf.union(index, index + size);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// connect with up site</span></span><br><span class="line">        <span class="keyword">if</span> (row &gt; <span class="number">1</span> &amp;&amp; site[index - size]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!topFlag &amp;&amp; connectTop[uf.find(index - size)] || connectTop[uf.find(index)]) &#123;</span><br><span class="line">                topFlag = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (!bottomFlag &amp;&amp; connectBottom[uf.find(index - size)] || connectBottom[uf.find(index)]) &#123;</span><br><span class="line">                bottomFlag = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            uf.union(index, index - size);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// connect with right site</span></span><br><span class="line">        <span class="keyword">if</span> (col &lt; size &amp;&amp; site[index + <span class="number">1</span>]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!topFlag &amp;&amp; connectTop[uf.find(index + <span class="number">1</span>)] || connectTop[uf.find(index)]) &#123;</span><br><span class="line">                topFlag = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (!bottomFlag &amp;&amp; connectBottom[uf.find(index + <span class="number">1</span>)] || connectBottom[uf.find(index)]) &#123;</span><br><span class="line">                bottomFlag = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            uf.union(index, index + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// connect with left site</span></span><br><span class="line">        <span class="keyword">if</span> (col &gt; <span class="number">1</span> &amp;&amp; site[index - <span class="number">1</span>]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!topFlag &amp;&amp; connectTop[uf.find(index - <span class="number">1</span>)] || connectTop[uf.find(index)]) &#123;</span><br><span class="line">                topFlag = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (!bottomFlag &amp;&amp; connectBottom[uf.find(index - <span class="number">1</span>)] || connectBottom[uf.find(index)]) &#123;</span><br><span class="line">                bottomFlag = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            uf.union(index, index - <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        connectTop[uf.find(index)] = topFlag;</span><br><span class="line">        connectBottom[uf.find(index)] = bottomFlag;</span><br><span class="line">        <span class="keyword">if</span> (!percolateFlag &amp;&amp; connectTop[uf.find(index)] &amp;&amp; connectBottom[uf.find(index)]) &#123;</span><br><span class="line">            percolateFlag = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isOpen</span><span class="params">(<span class="type">int</span> row, <span class="type">int</span> col)</span> &#123;</span><br><span class="line">        validate(row, col);</span><br><span class="line">        <span class="keyword">return</span> site[xyTo1D(row, col)];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** A full site is an open site that can be connected to an open site in the</span></span><br><span class="line"><span class="comment">     *  top row via a chain of neighboring (left, right, up, down) open sites.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isFull</span><span class="params">(<span class="type">int</span> row, <span class="type">int</span> col)</span> &#123;</span><br><span class="line">        validate(row, col);</span><br><span class="line">        <span class="keyword">return</span> connectTop[uf.find(xyTo1D(row, col))];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">numberOfOpenSites</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> numberOfOpenSites;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** Introduce 2 virtual sites (and connections to top and bottom).</span></span><br><span class="line"><span class="comment">     *  Percolates if virtual top site is connected to virtual bottom site.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">percolates</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> percolateFlag;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="title function_">xyTo1D</span><span class="params">(<span class="type">int</span> row, <span class="type">int</span> col)</span> &#123;</span><br><span class="line">        validate(row, col);</span><br><span class="line">        <span class="keyword">return</span> size * (row - <span class="number">1</span>) + col - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">validate</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (n &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">validate</span><span class="params">(<span class="type">int</span> row, <span class="type">int</span> col)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (row &lt;= <span class="number">0</span> || row &gt; size || col &lt;= <span class="number">0</span> || col &gt; size) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// test client (optional)</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>方法 4：最终方法</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> percolation;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> edu.princeton.cs.algs4.WeightedQuickUnionUF;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Percolation</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span>[] grid;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span>[] connectBottom;</span><br><span class="line">    <span class="keyword">private</span> WeightedQuickUnionUF uf;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span> size;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span> virtualTop;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> numberOfOpenSites;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// creates n-by-n grid, with all sites initially blocked</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Percolation</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">        </span><br><span class="line">        validate(n);</span><br><span class="line">        </span><br><span class="line">        grid = <span class="keyword">new</span> <span class="title class_">boolean</span>[n*n];</span><br><span class="line">        <span class="comment">// last 1 use as virtualTop</span></span><br><span class="line">        connectBottom = <span class="keyword">new</span> <span class="title class_">boolean</span>[n*n+<span class="number">1</span>];</span><br><span class="line">        uf = <span class="keyword">new</span> <span class="title class_">WeightedQuickUnionUF</span>(n*n+<span class="number">1</span>);</span><br><span class="line">        size = n;</span><br><span class="line">        virtualTop = n*n;</span><br><span class="line">        numberOfOpenSites = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// opens the site (row, col) if it is not open already</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">open</span><span class="params">(<span class="type">int</span> row, <span class="type">int</span> col)</span> &#123;</span><br><span class="line">        </span><br><span class="line">        validate(row, col);</span><br><span class="line">        </span><br><span class="line">        <span class="type">int</span> <span class="variable">center</span> <span class="operator">=</span> xyTo1D(row, col);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// if (row, col) is already opened</span></span><br><span class="line">        <span class="keyword">if</span> (grid[center]) &#123;</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// else not opened</span></span><br><span class="line">        grid[center] = <span class="literal">true</span>;</span><br><span class="line">        numberOfOpenSites++;</span><br><span class="line">        </span><br><span class="line">        <span class="type">int</span> <span class="variable">above</span> <span class="operator">=</span> xyTo1D(row-<span class="number">1</span>, col);</span><br><span class="line">        <span class="type">int</span> <span class="variable">below</span> <span class="operator">=</span> xyTo1D(row+<span class="number">1</span>, col);</span><br><span class="line">        <span class="type">int</span> <span class="variable">left</span> <span class="operator">=</span> xyTo1D(row, col-<span class="number">1</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">right</span> <span class="operator">=</span> xyTo1D(row, col+<span class="number">1</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// if (row, col) is on the bottom, set connectBottom[] true </span></span><br><span class="line">        <span class="keyword">if</span> (row == size) &#123;</span><br><span class="line">            connectBottom[center] = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// judge if exist a union operation that union a tree whose root has connectBottom[root] == true</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">bottomFlag</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// check above, (row - 1, col)</span></span><br><span class="line">        <span class="keyword">if</span> (row &gt; <span class="number">1</span> &amp;&amp; grid[above]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (connectBottom[uf.find(center)] || connectBottom[uf.find(above)]) &#123;</span><br><span class="line">                bottomFlag = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            uf.union(center, above);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// check below, (row + 1, col)</span></span><br><span class="line">        <span class="keyword">if</span> (row &lt; size &amp;&amp; grid[below]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (connectBottom[uf.find(center)] || connectBottom[uf.find(below)]) &#123;</span><br><span class="line">                bottomFlag = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            uf.union(center, below);</span><br><span class="line">        &#125; </span><br><span class="line">        </span><br><span class="line">        <span class="comment">// check left, (row, col - 1)</span></span><br><span class="line">        <span class="keyword">if</span> (col &gt; <span class="number">1</span> &amp;&amp; grid[left]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (connectBottom[uf.find(center)] || connectBottom[uf.find(left)]) &#123;</span><br><span class="line">                bottomFlag = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            uf.union(center, left);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// check right, (row, col + 1)</span></span><br><span class="line">        <span class="keyword">if</span> (col &lt; size &amp;&amp; grid[right]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (connectBottom[uf.find(center)] || connectBottom[uf.find(right)]) &#123;</span><br><span class="line">                bottomFlag = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            uf.union(center, right);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// if row == 1, should have one more union: union with virtual top</span></span><br><span class="line">        <span class="keyword">if</span> (row == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (connectBottom[uf.find(center)] || connectBottom[uf.find(virtualTop)]) &#123;</span><br><span class="line">                bottomFlag = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            uf.union(center, virtualTop);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// if bottom Flag is true, then set connectBottom[root of center] to true after all union ops</span></span><br><span class="line">        <span class="keyword">if</span> (bottomFlag) &#123;</span><br><span class="line">            connectBottom[uf.find(center)] = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// is the site (row, col) open?</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isOpen</span><span class="params">(<span class="type">int</span> row, <span class="type">int</span> col)</span> &#123;</span><br><span class="line">        validate(row, col);</span><br><span class="line">        <span class="keyword">return</span> grid[xyTo1D(row, col)];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// is the site (row, col) full?</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isFull</span><span class="params">(<span class="type">int</span> row, <span class="type">int</span> col)</span> &#123;</span><br><span class="line">        validate(row, col);</span><br><span class="line">        <span class="keyword">return</span> isOpen(row, col) &amp;&amp; uf.connected(xyTo1D(row, col), virtualTop);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// returns the number of open sites</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">numberOfOpenSites</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> numberOfOpenSites;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// does the system percolate?</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">percolates</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> connectBottom[uf.find(virtualTop)];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// mapping 2D coordinates to 1D coordinates</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="title function_">xyTo1D</span><span class="params">(<span class="type">int</span> row, <span class="type">int</span> col)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (row - <span class="number">1</span>)*size + (col - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">validate</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (n &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;ERROR: grid size n must be greater than 0&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">validate</span><span class="params">(<span class="type">int</span> row, <span class="type">int</span> col)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (row &lt; <span class="number">1</span> || row &gt; size || col &lt; <span class="number">1</span> || col &gt; size) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;ERROR: given (row, col) is outside prescribed range&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// test client (optional)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://example.com">RQTN</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://example.com/princeton-algs4/02-ALGS4-Assignment1-Backwash-In-Percolation/">http://example.com/princeton-algs4/02-ALGS4-Assignment1-Backwash-In-Percolation/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">RQTN</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/princeton-algs4/">princeton-algs4</a></div><div class="post_share"></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/princeton-algs4/01-ALGS4-Union-Find/" title="Union-Find"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Union-Find</div></div></a></div><div class="next-post pull-right"><a href="/mit-18.06/mit-18.06-lec01/" title="Lec01 - 方程组的几何解释"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Lec01 - 方程组的几何解释</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/princeton-algs4/01-ALGS4-Union-Find/" title="Union-Find"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-08-11</div><div class="title">Union-Find</div></div></a></div><div><a href="/princeton-algs4/03-ALGS4-Analysis-Of-Algorithms/" title="Analysis Of Algorithms"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-08-18</div><div class="title">Analysis Of Algorithms</div></div></a></div><div><a href="/princeton-algs4/04-ALGS4-Assignment2-Queues/" title="Assignment2 - Queues"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-08-22</div><div class="title">Assignment2 - Queues</div></div></a></div><div><a href="/princeton-algs4/05-ALGS4-Stacks-And-Queues/" title="Stacks And Queues"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-08-22</div><div class="title">Stacks And Queues</div></div></a></div><div><a href="/princeton-algs4/06-ALGS4-Elementary-Sorts/" title="Elementary Sorts"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-08-31</div><div class="title">Elementary Sorts</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">RQTN</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">63</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">36</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">17</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/RQTN"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/RQTN" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Assignment1-backwash-in-Percolation"><span class="toc-number">1.</span> <span class="toc-text">Assignment1 - backwash in Percolation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#backwash-%E9%97%AE%E9%A2%98"><span class="toc-number">1.1.</span> <span class="toc-text">backwash 问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3-backwash-%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-number">1.2.</span> <span class="toc-text">解决 backwash 的方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81"><span class="toc-number">1.3.</span> <span class="toc-text">代码</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/itheima-mysql/MVCC%20-%20undo%20log%20%E7%89%88%E6%9C%AC%E9%93%BE%E6%95%B0%E6%8D%AE%E8%AE%BF%E9%97%AE%E8%A7%84%E5%88%99/" title="MVCC - undo log 版本链数据访问规则">MVCC - undo log 版本链数据访问规则</a><time datetime="2023-06-27T14:19:24.000Z" title="发表于 2023-06-27 22:19:24">2023-06-27</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/itheima-juc/synchronized%20%E5%8E%9F%E7%90%86/" title="synchronized 原理">synchronized 原理</a><time datetime="2023-05-04T09:46:08.000Z" title="发表于 2023-05-04 17:46:08">2023-05-04</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/itheima-juc/%E5%A5%BD%E6%96%87%E6%94%B6%E5%BD%95-%E6%AD%BB%E7%A3%95Synchronized%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0--%E9%87%8D%E9%87%8F%E7%BA%A7%E9%94%81/" title="好文收录 - 死磕Synchronized底层实现--重量级锁">好文收录 - 死磕Synchronized底层实现--重量级锁</a><time datetime="2023-04-27T17:00:08.000Z" title="发表于 2023-04-28 01:00:08">2023-04-28</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/itheima-juc/%E5%A5%BD%E6%96%87%E6%94%B6%E5%BD%95-%E6%AD%BB%E7%A3%95Synchronized%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0--%E8%BD%BB%E9%87%8F%E7%BA%A7%E9%94%81/" title="好文收录 - 死磕Synchronized底层实现--轻量级锁">好文收录 - 死磕Synchronized底层实现--轻量级锁</a><time datetime="2023-04-26T17:00:08.000Z" title="发表于 2023-04-27 01:00:08">2023-04-27</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/itheima-juc/%E5%A5%BD%E6%96%87%E6%94%B6%E5%BD%95-%E6%AD%BB%E7%A3%95Synchronized%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0--%E5%81%8F%E5%90%91%E9%94%81/" title="好文收录 - 死磕Synchronized底层实现--偏向锁">好文收录 - 死磕Synchronized底层实现--偏向锁</a><time datetime="2023-04-25T17:00:08.000Z" title="发表于 2023-04-26 01:00:08">2023-04-26</time></div></div></div></div></div></div></main><footer id="footer" style="background: linear-gradient(20deg, #0062be, #925696, #cc426e, #fb0347)"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2024 By RQTN</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://unpkg.com/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://unpkg.com/mathjax@3.2.2/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script></div><script defer="defer" id="ribbon" src="https://unpkg.com/butterfly-extsrc@1.1.3/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="true"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>