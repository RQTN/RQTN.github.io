<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>坦克大战 - 防止敌人坦克重叠 踩坑记录 | RQTN</title><meta name="author" content="RQTN"><meta name="copyright" content="RQTN"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="坦克大战 - 防止敌人坦克重叠 踩坑记录目前，我们在 chapter_18 中完成的坦克大战 0.4 版还存在一个问题：敌人坦克在运动时会发生重叠现象！现在在 chapter_20 中我们就要解决这个问题。 启动点（目前我的坦克大战代码） 我的启动点和老韩的代码存在一定差异，这里先给出目前我的坦克大战代码，方便后续基于我的代码实现时进行说明  Tank 类：12345678910111213141">
<meta property="og:type" content="article">
<meta property="og:title" content="坦克大战 - 防止敌人坦克重叠 踩坑记录">
<meta property="og:url" content="http://example.com/hsp-javase/ch20-%E5%9D%A6%E5%85%8B%E5%A4%A7%E6%88%98%20-%20%E9%98%B2%E6%AD%A2%E6%95%8C%E4%BA%BA%E5%9D%A6%E5%85%8B%E9%87%8D%E5%8F%A0%E8%B8%A9%E5%9D%91%E8%AE%B0%E5%BD%95/index.html">
<meta property="og:site_name" content="RQTN">
<meta property="og:description" content="坦克大战 - 防止敌人坦克重叠 踩坑记录目前，我们在 chapter_18 中完成的坦克大战 0.4 版还存在一个问题：敌人坦克在运动时会发生重叠现象！现在在 chapter_20 中我们就要解决这个问题。 启动点（目前我的坦克大战代码） 我的启动点和老韩的代码存在一定差异，这里先给出目前我的坦克大战代码，方便后续基于我的代码实现时进行说明  Tank 类：12345678910111213141">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/avatar.jpg">
<meta property="article:published_time" content="2022-08-24T05:17:20.000Z">
<meta property="article:modified_time" content="2024-04-01T01:43:24.243Z">
<meta property="article:author" content="RQTN">
<meta property="article:tag" content="hsp-javase">
<meta property="article:tag" content="坦克大战">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/avatar.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/hsp-javase/ch20-%E5%9D%A6%E5%85%8B%E5%A4%A7%E6%88%98%20-%20%E9%98%B2%E6%AD%A2%E6%95%8C%E4%BA%BA%E5%9D%A6%E5%85%8B%E9%87%8D%E5%8F%A0%E8%B8%A9%E5%9D%91%E8%AE%B0%E5%BD%95/index.html"><link rel="preconnect" href="//unpkg.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://unpkg.com/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://unpkg.com/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":100,"languages":{"author":"作者: RQTN","link":"链接: ","source":"来源: RQTN","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://unpkg.com/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '坦克大战 - 防止敌人坦克重叠 踩坑记录',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-04-01 09:43:24'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.1.1"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">63</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">36</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">17</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/index_img_cut.png')"><nav id="nav"><span id="blog-info"><a href="/" title="RQTN"><span class="site-name">RQTN</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">坦克大战 - 防止敌人坦克重叠 踩坑记录</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">发表于</span><time datetime="2022-08-24T05:17:20.000Z" title="发表于 2022-08-24 13:17:20">2022-08-24</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Java/">Java</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Java/JavaSE/">JavaSE</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">7.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>32分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="坦克大战 - 防止敌人坦克重叠 踩坑记录"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="坦克大战-防止敌人坦克重叠-踩坑记录"><a href="#坦克大战-防止敌人坦克重叠-踩坑记录" class="headerlink" title="坦克大战 - 防止敌人坦克重叠 踩坑记录"></a>坦克大战 - 防止敌人坦克重叠 踩坑记录</h2><p>目前，我们在 <code>chapter_18</code> 中完成的坦克大战 0.4 版还存在一个问题：敌人坦克在运动时会发生重叠现象！现在在 <code>chapter_20</code> 中我们就要解决这个问题。</p>
<h3 id="启动点（目前我的坦克大战代码）"><a href="#启动点（目前我的坦克大战代码）" class="headerlink" title="启动点（目前我的坦克大战代码）"></a>启动点（目前我的坦克大战代码）</h3><blockquote>
<p>我的启动点和老韩的代码存在一定差异，这里先给出目前我的坦克大战代码，方便后续基于我的代码实现时进行说明</p>
</blockquote>
<h4 id="Tank-类："><a href="#Tank-类：" class="headerlink" title="Tank 类："></a><code>Tank</code> 类：</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.hspedu.tankgame5;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> RQTN</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * 父类坦克</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Tank</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> x;          <span class="comment">// 坦克的横坐标</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> y;          <span class="comment">// 坦克的纵坐标</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">direct</span> <span class="operator">=</span> <span class="number">0</span>; <span class="comment">// 坦克的朝向（上/右/下/左 -&gt; 0/1/2/3）</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">speed</span> <span class="operator">=</span> <span class="number">2</span>;  <span class="comment">// 坦克的速度（每次移动的像素个数）</span></span><br><span class="line">    <span class="keyword">private</span> Color color;    <span class="comment">// 坦克的颜色（玩家坦克和电脑坦克颜色不同）</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="variable">isAlive</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Tank</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.x = x;</span><br><span class="line">        <span class="built_in">this</span>.y = y;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getX</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setX</span><span class="params">(<span class="type">int</span> x)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.x = x;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getY</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> y;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setY</span><span class="params">(<span class="type">int</span> y)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.y = y;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getDirect</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> direct;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setDirect</span><span class="params">(<span class="type">int</span> direct)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.direct = direct;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getSpeed</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> speed;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setSpeed</span><span class="params">(<span class="type">int</span> speed)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.speed = speed;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Color <span class="title function_">getColor</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> color;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setColor</span><span class="params">(Color color)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.color = color;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isAlive</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> isAlive;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAlive</span><span class="params">(<span class="type">boolean</span> alive)</span> &#123;</span><br><span class="line">        isAlive = alive;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 坦克上右下左移动方法</span></span><br><span class="line">    <span class="comment">// 在坦克上右下左移动方法中，加入对边界情况的限制！</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">moveUp</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (y - speed &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            y -= speed;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            y = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">moveRight</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (x + <span class="number">60</span> + speed &lt; MyPanel.WIDTH) &#123;</span><br><span class="line">            x += speed;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            x = MyPanel.WIDTH - <span class="number">60</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">moveDown</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (y + <span class="number">60</span> + speed &lt; MyPanel.HEIGHT) &#123;</span><br><span class="line">            y += speed;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            y = MyPanel.HEIGHT - <span class="number">60</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">moveLeft</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (x - speed &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            x -= speed;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            x = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取本坦克炮口的位置</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> int[] 即炮口的 xy 坐标</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span>[] getMuzzleXY() &#123;</span><br><span class="line">        <span class="keyword">switch</span> (direct) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">0</span>: <span class="comment">// 上</span></span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;x + <span class="number">20</span>, y&#125;;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">1</span>: <span class="comment">// 右</span></span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;x + <span class="number">60</span>, y + <span class="number">20</span>&#125;;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">2</span>: <span class="comment">// 下</span></span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;x + <span class="number">20</span>, y + <span class="number">60</span>&#125;;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">3</span>: <span class="comment">// 左</span></span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;x, y + <span class="number">20</span>&#125;;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 判断某个点的坐标是否落在本坦克对应的矩形内部</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> x 该点的 x 坐标</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> y 该点的 y 坐标</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 如果该点落在本坦克对应的矩形内部，返回 true，否则返回 false</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isPointInTank</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;</span><br><span class="line">        <span class="keyword">switch</span> (direct) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                <span class="keyword">if</span> (x &gt;= <span class="built_in">this</span>.x &amp;&amp; x &lt;= <span class="built_in">this</span>.x + <span class="number">40</span></span><br><span class="line">                        &amp;&amp; y &gt;= <span class="built_in">this</span>.y &amp;&amp; y &lt;= <span class="built_in">this</span>.y + <span class="number">60</span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">                <span class="keyword">if</span> (x &gt;= <span class="built_in">this</span>.x &amp;&amp; x &lt;= <span class="built_in">this</span>.x + <span class="number">60</span></span><br><span class="line">                        &amp;&amp; y &gt;= <span class="built_in">this</span>.y &amp;&amp; y &lt;= <span class="built_in">this</span>.y + <span class="number">40</span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="EnemyTank-类"><a href="#EnemyTank-类" class="headerlink" title="EnemyTank 类"></a><code>EnemyTank</code> 类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.hspedu.tankgame5;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"><span class="keyword">import</span> java.util.Vector;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> RQTN</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EnemyTank</span> <span class="keyword">extends</span> <span class="title class_">Tank</span> <span class="keyword">implements</span> <span class="title class_">Runnable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Color</span> <span class="variable">ENEMY_COLOR</span> <span class="operator">=</span> Color.CYAN;</span><br><span class="line">    <span class="keyword">private</span> Vector&lt;Shot&gt; shots = <span class="keyword">new</span> <span class="title class_">Vector</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">EnemyTank</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(x, y);</span><br><span class="line">        setColor(ENEMY_COLOR);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Vector&lt;Shot&gt; <span class="title function_">getShots</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> shots;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">shotHero</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// 规定在游戏区域上，电脑坦克最多同时出现 1 颗子弹</span></span><br><span class="line">        <span class="keyword">if</span> (!isAlive() || shots.size() == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span>[] muzzleXY = getMuzzleXY();</span><br><span class="line">        <span class="comment">// 根据炮口位置和坦克方向创建子弹</span></span><br><span class="line">        <span class="type">Shot</span> <span class="variable">shot</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Shot</span>(muzzleXY[<span class="number">0</span>], muzzleXY[<span class="number">1</span>], getDirect());</span><br><span class="line">        shot.setColor(ENEMY_COLOR);</span><br><span class="line">        shots.add(shot);</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(shot).start();   <span class="comment">// 启动子弹线程</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 为了让电脑坦克可以随机移动，应将其实现为一个线程类</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">start1</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="type">long</span> <span class="variable">start2</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (isAlive()) &#123;</span><br><span class="line">            <span class="comment">// 每 50 ms 电脑坦克移动一次</span></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Thread.sleep(<span class="number">50</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">switch</span> (getDirect()) &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">0</span>: <span class="comment">// 上</span></span><br><span class="line">                    moveUp();</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">1</span>: <span class="comment">// 右</span></span><br><span class="line">                    moveRight();</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">2</span>: <span class="comment">// 下</span></span><br><span class="line">                    moveDown();</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">3</span>: <span class="comment">// 左</span></span><br><span class="line">                    moveLeft();</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 每 2~4 s 敌人坦克尝试改变一下方向</span></span><br><span class="line">            <span class="keyword">if</span> (System.currentTimeMillis() - start1 &gt; <span class="number">1000</span> * ((<span class="type">int</span>) (Math.random() * <span class="number">3</span>) + <span class="number">2</span>)) &#123;</span><br><span class="line">                start1 = System.currentTimeMillis();</span><br><span class="line">                setDirect((<span class="type">int</span>) (Math.random() * <span class="number">4</span>));</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 每 4~6 s 敌人坦克尝试发射一下子弹</span></span><br><span class="line">            <span class="keyword">if</span> (System.currentTimeMillis() - start2 &gt; <span class="number">1000</span> * ((<span class="type">int</span>) (Math.random() * <span class="number">3</span>) + <span class="number">4</span>)) &#123;</span><br><span class="line">                start2 = System.currentTimeMillis();</span><br><span class="line">                shotHero();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;敌人坦克线程结束~&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="Hero-类"><a href="#Hero-类" class="headerlink" title="Hero 类"></a><code>Hero</code> 类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.hspedu.tankgame5;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"><span class="keyword">import</span> java.util.Vector;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> RQTN</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * 玩家坦克</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Hero</span> <span class="keyword">extends</span> <span class="title class_">Tank</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Color</span> <span class="variable">HERO_COLOR</span> <span class="operator">=</span> Color.YELLOW;</span><br><span class="line">    <span class="keyword">private</span> Vector&lt;Shot&gt; shots = <span class="keyword">new</span> <span class="title class_">Vector</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Hero</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(x, y);</span><br><span class="line">        setColor(HERO_COLOR);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Vector&lt;Shot&gt; <span class="title function_">getShots</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> shots;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">shotEnemyTank</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// 规定在游戏区域上，玩家坦克最多同时出现 5 颗子弹</span></span><br><span class="line">        <span class="keyword">if</span> (!isAlive() || shots.size() == <span class="number">5</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span>[] muzzleXY = getMuzzleXY();</span><br><span class="line">        <span class="comment">// 根据炮口位置和坦克方向创建子弹</span></span><br><span class="line">        <span class="type">Shot</span> <span class="variable">shot</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Shot</span>(muzzleXY[<span class="number">0</span>], muzzleXY[<span class="number">1</span>], getDirect());</span><br><span class="line">        shot.setColor(HERO_COLOR);</span><br><span class="line">        shots.add(shot);</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(shot).start(); <span class="comment">// 启动子弹线程</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="Shot-类"><a href="#Shot-类" class="headerlink" title="Shot 类"></a><code>Shot</code> 类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.hspedu.tankgame5;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 表示一个子弹（的射击行为）</span></span><br><span class="line"><span class="comment"> * 子弹射出后会沿射击方向不断运动，因此将 Shot 实现为一个线程类</span></span><br><span class="line"><span class="comment"> * 该线程类启动后，run 方法中不断去更新子弹的 xy 坐标！</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Shot</span> <span class="keyword">implements</span> <span class="title class_">Runnable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> x;  <span class="comment">// 子弹 x 坐标</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> y;  <span class="comment">// 子弹 y 坐标</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span> direct; <span class="comment">// 子弹的运动朝向（子弹打出后不可能拐弯，可设为 final）</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">speed</span> <span class="operator">=</span> <span class="number">3</span>;  <span class="comment">// 子弹的运动速度</span></span><br><span class="line">    <span class="keyword">private</span> Color color;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="variable">isAlive</span> <span class="operator">=</span> <span class="literal">true</span>;    <span class="comment">// 子弹是否还存活</span></span><br><span class="line">    <span class="comment">// isAlive 用于控制两个行为：</span></span><br><span class="line">    <span class="comment">// 1. 是否继续更新子弹位置（即子弹线程是否退出）</span></span><br><span class="line">    <span class="comment">// 2. 是否继续重绘子弹</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Shot</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> direct)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.x = x;</span><br><span class="line">        <span class="built_in">this</span>.y = y;</span><br><span class="line">        <span class="built_in">this</span>.direct = direct;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getX</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setX</span><span class="params">(<span class="type">int</span> x)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.x = x;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getY</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> y;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setY</span><span class="params">(<span class="type">int</span> y)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.y = y;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getDirect</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> direct;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isAlive</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> isAlive;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAlive</span><span class="params">(<span class="type">boolean</span> alive)</span> &#123;</span><br><span class="line">        isAlive = alive;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getSpeed</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> speed;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setSpeed</span><span class="params">(<span class="type">int</span> speed)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.speed = speed;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Color <span class="title function_">getColor</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> color;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setColor</span><span class="params">(Color color)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.color = color;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">while</span> (isAlive) &#123;</span><br><span class="line">            <span class="comment">// 每隔 50ms 移动一次子弹，更新其 xy 坐标</span></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Thread.sleep(<span class="number">50</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 根据方向更新 xy 坐标</span></span><br><span class="line">            <span class="keyword">switch</span> (direct) &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">0</span>: <span class="comment">// 上</span></span><br><span class="line">                    y -= speed;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">1</span>: <span class="comment">// 右</span></span><br><span class="line">                    x += speed;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">2</span>: <span class="comment">// 下</span></span><br><span class="line">                    y += speed;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">3</span>: <span class="comment">// 左</span></span><br><span class="line">                    x -= speed;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// System.out.println(Thread.currentThread().getName() + &quot; (&quot; + x + &quot;, &quot; + y +  &quot;)&quot;);</span></span><br><span class="line">            <span class="comment">// 检查更新后子弹是否超过游戏区域边界</span></span><br><span class="line">            <span class="comment">// 注意：外界也可能设置 isAlive 为 false，从而以通知的方式让子弹线程结束！</span></span><br><span class="line">            <span class="keyword">if</span> (x &lt; <span class="number">0</span> || x &gt; MyPanel.WIDTH || y &lt; <span class="number">0</span> || y &gt; MyPanel.HEIGHT) &#123;</span><br><span class="line">                isAlive = <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;子弹线程结束~&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="Bomb-类"><a href="#Bomb-类" class="headerlink" title="Bomb 类"></a><code>Bomb</code> 类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.hspedu.tankgame5;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Bomb</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 爆炸效果本质上是通过绘制爆炸图片来完成</span></span><br><span class="line">    <span class="comment">// 这里有三张爆炸图片，分别用于整个动态爆炸效果展示的三个阶段</span></span><br><span class="line">    <span class="comment">// life 为 7~9 时绘制 bombImage1，为 4~6 时绘制 bombImage2，为 1~3 时绘制 bombImage3</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> Image bombImage1;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> Image bombImage2;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> Image bombImage3;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="type">Toolkit</span> <span class="variable">toolkit</span> <span class="operator">=</span> Toolkit.getDefaultToolkit();</span><br><span class="line">        bombImage1 = toolkit.getImage(Panel.class.getResource(<span class="string">&quot;/bomb_1.gif&quot;</span>));</span><br><span class="line">        bombImage2 = toolkit.getImage(Panel.class.getResource(<span class="string">&quot;/bomb_2.gif&quot;</span>));</span><br><span class="line">        bombImage3 = toolkit.getImage(Panel.class.getResource(<span class="string">&quot;/bomb_3.gif&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> x;  <span class="comment">// 爆炸效果的横坐标</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> y;  <span class="comment">// 爆炸效果的纵坐标</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">life</span> <span class="operator">=</span> <span class="number">9</span>;   <span class="comment">// 爆炸持续时间（持续在连续 9 次画板绘制中出现）</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="variable">isAlive</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Bomb</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.x = x;</span><br><span class="line">        <span class="built_in">this</span>.y = y;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getX</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setX</span><span class="params">(<span class="type">int</span> x)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.x = x;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getY</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> y;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setY</span><span class="params">(<span class="type">int</span> y)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.y = y;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getLife</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> life;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isAlive</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> isAlive;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAlive</span><span class="params">(<span class="type">boolean</span> alive)</span> &#123;</span><br><span class="line">        isAlive = alive;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 画板每绘制一次，递减一次爆炸的持续时间</span></span><br><span class="line"><span class="comment">     * 该方法主要用于更好更逼真地绘制爆炸效果</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">lifeDown</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (life &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            life--;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            isAlive = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="MyPanel-类"><a href="#MyPanel-类" class="headerlink" title="MyPanel 类"></a><code>MyPanel</code> 类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.hspedu.tankgame5;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"><span class="keyword">import</span> java.awt.event.KeyEvent;</span><br><span class="line"><span class="keyword">import</span> java.awt.event.KeyListener;</span><br><span class="line"><span class="keyword">import</span> java.util.Vector;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> RQTN</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * 坦克大战的绘图画板（游戏区域）</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyPanel</span> <span class="keyword">extends</span> <span class="title class_">JPanel</span> <span class="keyword">implements</span> <span class="title class_">KeyListener</span>, Runnable &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">WIDTH</span> <span class="operator">=</span> <span class="number">1000</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">HEIGHT</span> <span class="operator">=</span> <span class="number">750</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">Hero</span> <span class="variable">hero</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="comment">// 后续涉及到多线程，故使用 Vector 作为容器</span></span><br><span class="line">    <span class="keyword">private</span> Vector&lt;EnemyTank&gt; enemyTanks = <span class="keyword">new</span> <span class="title class_">Vector</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">enemyTankSize</span> <span class="operator">=</span> <span class="number">9</span>;</span><br><span class="line">    <span class="keyword">private</span> Vector&lt;Bomb&gt; bombs = <span class="keyword">new</span> <span class="title class_">Vector</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyPanel</span><span class="params">()</span> &#123;</span><br><span class="line">        hero = <span class="keyword">new</span> <span class="title class_">Hero</span>(<span class="number">200</span>, <span class="number">200</span>);  <span class="comment">// 初始化一台玩家坦克，初始位置为 (200, 200)</span></span><br><span class="line">        <span class="comment">// 初始化三台电脑坦克</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; enemyTankSize; i++) &#123;</span><br><span class="line">            <span class="type">EnemyTank</span> <span class="variable">enemyTank</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">EnemyTank</span>((<span class="number">100</span>) * (i + <span class="number">1</span>), <span class="number">0</span>);</span><br><span class="line">            enemyTank.setDirect(<span class="number">2</span>);</span><br><span class="line">            <span class="comment">// 启动电脑坦克线程，使其开始随机移动</span></span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Thread</span>(enemyTank).start();</span><br><span class="line">            enemyTanks.add(enemyTank);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">paint</span><span class="params">(Graphics g)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.paint(g);</span><br><span class="line">        <span class="comment">// 坦克大战的区域/地图，为填充矩形，默认黑色</span></span><br><span class="line">        g.fillRect(<span class="number">0</span>, <span class="number">0</span>, WIDTH, HEIGHT);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 画坦克的代码较多，且坦克的朝向和类型均会影响坦克的绘制，因此最佳实践是封装为方法</span></span><br><span class="line">        <span class="comment">// 绘制玩家坦克</span></span><br><span class="line">        <span class="keyword">if</span> (hero.isAlive()) &#123;</span><br><span class="line">            drawTank(hero, g);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 绘制玩家坦克子弹</span></span><br><span class="line">        Vector&lt;Shot&gt; heroShots = hero.getShots();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; heroShots.size(); ) &#123;</span><br><span class="line">            <span class="type">Shot</span> <span class="variable">heroShot</span> <span class="operator">=</span> heroShots.get(i);</span><br><span class="line">            <span class="keyword">if</span> (heroShot.isAlive()) &#123;</span><br><span class="line">                drawShot(heroShot, g);</span><br><span class="line">                i++;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                heroShots.remove(heroShot);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 绘制电脑坦克和每个坦克的相应子弹</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; enemyTanks.size(); ) &#123;</span><br><span class="line">            <span class="type">EnemyTank</span> <span class="variable">enemyTank</span> <span class="operator">=</span> enemyTanks.get(i);</span><br><span class="line">            <span class="keyword">if</span> (enemyTank.isAlive()) &#123;</span><br><span class="line">                drawTank(enemyTank, g);</span><br><span class="line">                i++;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// 仅当电脑坦克的子弹也都死亡后，才将已死亡的电脑坦克移除</span></span><br><span class="line">                <span class="keyword">if</span> (enemyTank.getShots().size() == <span class="number">0</span>) &#123;</span><br><span class="line">                    enemyTanks.remove(enemyTank);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    i++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 电脑坦克死亡，其已经发射的子弹依然存活，需要进行绘制</span></span><br><span class="line">            Vector&lt;Shot&gt; shots = enemyTank.getShots();</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; shots.size(); ) &#123;</span><br><span class="line">                <span class="type">Shot</span> <span class="variable">enemyShot</span> <span class="operator">=</span> shots.get(j);</span><br><span class="line">                <span class="keyword">if</span> (enemyShot.isAlive()) &#123;</span><br><span class="line">                    drawShot(enemyShot, g);</span><br><span class="line">                    j++;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    shots.remove(enemyShot);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 绘制炸弹（爆炸效果）</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; bombs.size(); ) &#123;</span><br><span class="line">            <span class="type">Bomb</span> <span class="variable">bomb</span> <span class="operator">=</span> bombs.get(i);</span><br><span class="line">            drawBomb(bomb, g);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (bomb.isAlive()) &#123;</span><br><span class="line">                i++;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                bombs.remove(bomb);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 画坦克（由基础图形组装而成）</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> tank 坦克对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> g    可绘制各种基本图形的画笔</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">drawTank</span><span class="params">(Tank tank, Graphics g)</span> &#123;</span><br><span class="line"></span><br><span class="line">        g.setColor(tank.getColor());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 坦克的朝向会影响基础图形的组装绘制逻辑</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">x</span> <span class="operator">=</span> tank.getX();</span><br><span class="line">        <span class="type">int</span> <span class="variable">y</span> <span class="operator">=</span> tank.getY();</span><br><span class="line">        <span class="keyword">switch</span> (tank.getDirect()) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">0</span>: <span class="comment">// 上</span></span><br><span class="line">                g.fill3DRect(x, y, <span class="number">10</span>, <span class="number">60</span>, <span class="literal">false</span>);</span><br><span class="line">                g.fill3DRect(x + <span class="number">30</span>, y, <span class="number">10</span>, <span class="number">60</span>, <span class="literal">false</span>);</span><br><span class="line">                g.fill3DRect(x + <span class="number">10</span>, y + <span class="number">10</span>, <span class="number">20</span>, <span class="number">40</span>, <span class="literal">false</span>);</span><br><span class="line">                g.fillOval(x + <span class="number">10</span>, y + <span class="number">20</span>, <span class="number">20</span>, <span class="number">20</span>);</span><br><span class="line">                g.drawLine(x + <span class="number">20</span>, y + <span class="number">30</span>, x + <span class="number">20</span>, y);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">1</span>: <span class="comment">// 右</span></span><br><span class="line">                g.fill3DRect(x, y, <span class="number">60</span>, <span class="number">10</span>, <span class="literal">false</span>);</span><br><span class="line">                g.fill3DRect(x, y + <span class="number">30</span>, <span class="number">60</span>, <span class="number">10</span>, <span class="literal">false</span>);</span><br><span class="line">                g.fill3DRect(x + <span class="number">10</span>, y + <span class="number">10</span>, <span class="number">40</span>, <span class="number">20</span>, <span class="literal">false</span>);</span><br><span class="line">                g.fillOval(x + <span class="number">20</span>, y + <span class="number">10</span>, <span class="number">20</span>, <span class="number">20</span>);</span><br><span class="line">                g.drawLine(x + <span class="number">30</span>, y + <span class="number">20</span>, x + <span class="number">60</span>, y + <span class="number">20</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">2</span>: <span class="comment">// 下</span></span><br><span class="line">                g.fill3DRect(x, y, <span class="number">10</span>, <span class="number">60</span>, <span class="literal">false</span>);</span><br><span class="line">                g.fill3DRect(x + <span class="number">30</span>, y, <span class="number">10</span>, <span class="number">60</span>, <span class="literal">false</span>);</span><br><span class="line">                g.fill3DRect(x + <span class="number">10</span>, y + <span class="number">10</span>, <span class="number">20</span>, <span class="number">40</span>, <span class="literal">false</span>);</span><br><span class="line">                g.fillOval(x + <span class="number">10</span>, y + <span class="number">20</span>, <span class="number">20</span>, <span class="number">20</span>);</span><br><span class="line">                g.drawLine(x + <span class="number">20</span>, y + <span class="number">30</span>, x + <span class="number">20</span>, y + <span class="number">60</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">3</span>: <span class="comment">// 左</span></span><br><span class="line">                g.fill3DRect(x, y, <span class="number">60</span>, <span class="number">10</span>, <span class="literal">false</span>);</span><br><span class="line">                g.fill3DRect(x, y + <span class="number">30</span>, <span class="number">60</span>, <span class="number">10</span>, <span class="literal">false</span>);</span><br><span class="line">                g.fill3DRect(x + <span class="number">10</span>, y + <span class="number">10</span>, <span class="number">40</span>, <span class="number">20</span>, <span class="literal">false</span>);</span><br><span class="line">                g.fillOval(x + <span class="number">20</span>, y + <span class="number">10</span>, <span class="number">20</span>, <span class="number">20</span>);</span><br><span class="line">                g.drawLine(x + <span class="number">30</span>, y + <span class="number">20</span>, x, y + <span class="number">20</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                System.out.println(<span class="string">&quot;暂未处理~&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 绘制子弹</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> shot 子弹对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> g    可绘制各种基本图形的画笔</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">drawShot</span><span class="params">(Shot shot, Graphics g)</span> &#123;</span><br><span class="line">        g.setColor(shot.getColor());</span><br><span class="line">        g.draw3DRect(shot.getX(), shot.getY(), <span class="number">1</span>, <span class="number">1</span>, <span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 绘制炸弹（爆炸效果）</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> bomb 炸弹（爆炸效果）对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> g    可绘制图片的画笔</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">drawBomb</span><span class="params">(Bomb bomb, Graphics g)</span> &#123;</span><br><span class="line">        <span class="type">Image</span> <span class="variable">bombImage</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">bombLife</span> <span class="operator">=</span> bomb.getLife();</span><br><span class="line">        <span class="keyword">if</span> (bombLife &gt; <span class="number">6</span>) &#123;</span><br><span class="line">            bombImage = bomb.bombImage1;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (bombLife &gt; <span class="number">3</span>) &#123;</span><br><span class="line">            bombImage = bomb.bombImage2;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            bombImage = bomb.bombImage3;</span><br><span class="line">        &#125;</span><br><span class="line">        g.drawImage(bombImage, bomb.getX(), bomb.getY(), <span class="number">60</span>, <span class="number">60</span>, <span class="built_in">this</span>);</span><br><span class="line">        bomb.lifeDown();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 检查某一方子弹是否击中另一方的坦克，如果是则将子弹和坦克的 isAlive 都置 false，</span></span><br><span class="line"><span class="comment">     * 表示生命周期结束，并返回 true，否则返回 false</span></span><br><span class="line"><span class="comment">     * 具体实现：将坦克视为一个矩形，判断子弹的坐标是否落在坦克对应的矩形内部</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> shot 子弹对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> tank 坦克对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 如果子弹集中坦克，返回 true，否则返回 false</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isShotHitTank</span><span class="params">(Shot shot, Tank tank)</span> &#123;</span><br><span class="line">        <span class="comment">// 要求传入的 shot 和 tank 属于不同阵营</span></span><br><span class="line">        <span class="keyword">if</span> (shot.getColor().equals(tank.getColor())) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 要求传入的 shot 和 tank 目前还存活</span></span><br><span class="line">        <span class="keyword">if</span> (!shot.isAlive() || !tank.isAlive()) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (tank.isPointInTank(shot.getX(), shot.getY())) &#123;</span><br><span class="line">            shot.setAlive(<span class="literal">false</span>);</span><br><span class="line">            tank.setAlive(<span class="literal">false</span>);</span><br><span class="line">            bombs.add(<span class="keyword">new</span> <span class="title class_">Bomb</span>(tank.getX(), tank.getY()));</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 玩家坦克的子弹是否击中电脑坦克，如果是结束两者的生命周期</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">checkHeroShotEnemy</span><span class="params">()</span> &#123;</span><br><span class="line">        Vector&lt;Shot&gt; heroShots = hero.getShots();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; heroShots.size(); i++) &#123;</span><br><span class="line">            <span class="type">Shot</span> <span class="variable">heroShot</span> <span class="operator">=</span> heroShots.get(i);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; enemyTanks.size(); j++) &#123;</span><br><span class="line">                <span class="type">EnemyTank</span> <span class="variable">enemyTank</span> <span class="operator">=</span> enemyTanks.get(j);</span><br><span class="line">                isShotHitTank(heroShot, enemyTank);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 电脑坦克的子弹是否击中玩家坦克，如果是结束两者的生命周期</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">checkEnemyShotHero</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; enemyTanks.size(); i++) &#123;</span><br><span class="line">            <span class="type">EnemyTank</span> <span class="variable">enemyTank</span> <span class="operator">=</span> enemyTanks.get(i);</span><br><span class="line">            Vector&lt;Shot&gt; shots = enemyTank.getShots();</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; shots.size(); j++) &#123;</span><br><span class="line">                isShotHitTank(shots.get(j), hero);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">keyTyped</span><span class="params">(KeyEvent e)</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">keyPressed</span><span class="params">(KeyEvent e)</span> &#123;</span><br><span class="line">        <span class="keyword">switch</span> (e.getKeyCode()) &#123;</span><br><span class="line">            <span class="keyword">case</span> KeyEvent.VK_W:</span><br><span class="line">                hero.setDirect(<span class="number">0</span>);</span><br><span class="line">                hero.moveUp();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> KeyEvent.VK_D:</span><br><span class="line">                hero.setDirect(<span class="number">1</span>);</span><br><span class="line">                hero.moveRight();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> KeyEvent.VK_S:</span><br><span class="line">                hero.setDirect(<span class="number">2</span>);</span><br><span class="line">                hero.moveDown();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> KeyEvent.VK_A:</span><br><span class="line">                hero.setDirect(<span class="number">3</span>);</span><br><span class="line">                hero.moveLeft();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> KeyEvent.VK_J:</span><br><span class="line">                hero.shotEnemyTank();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        repaint();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">keyReleased</span><span class="params">(KeyEvent e)</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Thread.sleep(<span class="number">100</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            checkHeroShotEnemy();</span><br><span class="line">            checkEnemyShotHero();</span><br><span class="line"></span><br><span class="line">            repaint();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="HspTankGame05-类"><a href="#HspTankGame05-类" class="headerlink" title="HspTankGame05 类"></a><code>HspTankGame05</code> 类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.hspedu.tankgame5;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> RQTN</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HspTankGame05</span> <span class="keyword">extends</span> <span class="title class_">JFrame</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> MyPanel mp;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">HspTankGame05</span><span class="params">()</span> &#123;</span><br><span class="line">        mp = <span class="keyword">new</span> <span class="title class_">MyPanel</span>();</span><br><span class="line">        <span class="comment">// 启动画板线程，让画板定时重绘，刷新游戏显示</span></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(mp).start();</span><br><span class="line">        <span class="built_in">this</span>.add(mp);</span><br><span class="line">        <span class="built_in">this</span>.setSize(<span class="number">1050</span>, <span class="number">800</span>);</span><br><span class="line">        <span class="built_in">this</span>.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);</span><br><span class="line">        <span class="comment">// HspTankGame05 注册键盘监听器，当监听到键盘事件后，要求转发给 MyPanel 处理</span></span><br><span class="line">        <span class="built_in">this</span>.addKeyListener(mp);</span><br><span class="line">        <span class="built_in">this</span>.setVisible(<span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">HspTankGame05</span> <span class="variable">hspTankGame05</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HspTankGame05</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="老韩的思路解析"><a href="#老韩的思路解析" class="headerlink" title="老韩的思路解析"></a>老韩的思路解析</h3><p>老韩的实现<strong>仅限于防止敌人坦克重叠</strong>，其思路乍一看不咋地，但在我尝试自己的思路屡屡碰壁后，才发现老韩的实现确实是<strong>内藏设计</strong>的，我认为有两个比较关键的点：</p>
<ol>
<li>防止敌人坦克重叠的最终目标，是实现当坦克撞到其他坦克时能够停下的效果。<br>因此在发生碰撞后，一定要搞清楚，<strong>到底是限制谁的移动</strong>。<br>举个例子，假设坦克相撞时的情况如下：<br><img src="/img/hsp-javase/ch20-1.jpg" alt=""><br>当发生碰撞后，显然应该<strong>向右走的坦克停止移动，而向上走的坦克可以继续移动</strong>！</li>
<li>坦克相撞后，如何防止坦克之间粘连在一起？<br>坦克相撞后，如果没有设计好，很可能出现<strong>两辆坦克撞在一起后，就互相黏住无法移动的情况</strong>。</li>
</ol>
<p>老韩思路最核心的地方是：<strong>仅检查坦克朝向的两个顶点是否落在其他坦克的矩形内部</strong>！对应上面两点：</p>
<ol>
<li><p>明确了限制移动的主体，并给出了<strong>恰如其分</strong>的限制移动的条件，不多不少，如下图：<br><img src="/img/hsp-javase/ch20-2.jpg" alt=""></p>
<ul>
<li>若将向右移动的坦克作为主体时，我们仅检查其朝向的两个顶点（右上和右下）是否侵入了其他坦克的矩形内部，这里显然是的，所以向右移动的坦克不再向右移动！</li>
<li>向上移动的坦克将继续移动，不受影响，因为将其作为主体时，其朝向的两个顶点（左上和右上）并没有侵入其他坦克的矩形内部！</li>
</ul>
<p>在相撞后，向上移动的坦克，其背部的左下顶点其实已经侵入了向右移动的坦克的矩形内部。<br>因此如果将限制移动的条件扩大，将坦克背后的两个顶点也加入，那么这里向上移动的坦克被撞到后，就也会停止移动，这是不太合理的，因为其正前方是空阔的，完全可以移动！</p>
</li>
<li><p>没有检查坦克背部的两个顶点是否侵入了其他坦克的矩形内部，同时还<strong>为坦克相撞后分离提供了条件</strong>！<br><img src="/img/hsp-javase/ch20-2.jpg" alt=""><br>由 1. 已知，如果将坦克背后的两个顶点也加入限制移动的条件，那么向上移动的坦克就无法移动了。此时根据限制条件，向右移动的坦克也无法移动，如果向右移动的坦克尝试调转方向往左再移动，但因为<strong>调转方向后其背后的右上顶点仍然侵入了向上移动的坦克内部</strong>，所以形成了明明两辆坦克正前方都是空阔的，但却依然互相粘连在原地无法移动的奇怪现象。</p>
</li>
</ol>
<p>综上可以看到，老韩只检查坦克朝向的两个顶点，这种克制的思路背后巧妙之处！</p>
<hr>
<h3 id="老韩的思路在我的启动点上如何实现"><a href="#老韩的思路在我的启动点上如何实现" class="headerlink" title="老韩的思路在我的启动点上如何实现"></a>老韩的思路在我的启动点上如何实现</h3><blockquote>
<p>我的启动点和老韩的启动点存在差异，另外老韩的思路虽然设计巧妙，但在实现上却非常丑陋，存在大量冗余代码，这里进行优化，提高复用性，确保简洁！</p>
</blockquote>
<p>某坦克是否可继续移动，可分解为 3 步：</p>
<ol>
<li>实现函数 <code>f1(x, y, tank)</code>，判断某个点 <code>(x, y)</code> 是否落在某坦克 <code>tank</code> 的矩形区域内部</li>
<li>实现函数 <code>f2(tankA, tankB)</code>，获取坦克 <code>tankA</code> 朝向的两个顶点 <code>(x1, y1), (x2, y2)</code>，分别调用 <code>f1(x1, y1, tankB)</code> 和 <code>f1(x2, y2, tankB)</code>，检查顶点是否落在坦克 <code>tankB</code> 的矩形区域内部</li>
<li>实现函数 <code>f3(tankA, otherTanks)</code>，对于坦克 <code>tankA</code> 和 其他所有坦克 <code>otherTanks</code>，分别调用 <code>f2(tankA, otherTanks[i])</code>，检查坦克看 <code>tankA</code> 朝向的两个顶点，是否落在其他所有坦克中某一个坦克的矩形内部</li>
</ol>
<p>就上面的 <code>1.</code> 而言，<code>Tank</code> 类中存在一个具有相同功能的成员函数 <code>isPointInTank(int x, int y)</code>，我们可以直接利用，但在利用时一定要分清楚<strong>主体</strong>！</p>
<p><code>2.</code> 没有现成的函数，这里我们选择将其实现也放到 <code>Tank</code> 类中，实现如下（注意把握好，限制移动的主体到底是谁）：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 判断本坦克朝向的两个顶点，是否侵入其他坦克对应的矩形内部</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> anotherTank 其他坦克</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span> 如果本坦克朝向的两个顶点都没有侵入其他坦克对应的矩形内部，返回 false，否则返回 true</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isTouchAnotherTank</span><span class="params">(Tank anotherTank)</span> &#123;</span><br><span class="line">    <span class="comment">// 把握好主体：本坦克（this）朝向的两个顶点是否侵入了其他坦克 anotherTank 的矩形内部</span></span><br><span class="line">    <span class="comment">// 本坦克朝向的两个顶点与本坦克的方向有关，因此这里 switch 中放入的是 this.direct</span></span><br><span class="line">    <span class="keyword">switch</span> (direct) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">            <span class="comment">// 本坦克向上移动，判断本坦克的左上和右上，是否侵入了其他坦克 anotherTank</span></span><br><span class="line">            <span class="keyword">return</span> anotherTank.isPointInTank(x, y)</span><br><span class="line">                    || anotherTank.isPointInTank(x + <span class="number">40</span>, y);</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">            <span class="comment">// 本坦克向下移动，判断本坦克的左下和右下，是否侵入了其他坦克 anotherTank</span></span><br><span class="line">            <span class="keyword">return</span> anotherTank.isPointInTank(x, y + <span class="number">60</span>)</span><br><span class="line">                    || anotherTank.isPointInTank(x + <span class="number">40</span>, y + <span class="number">60</span>);</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            <span class="comment">// 本坦克向右移动，判断本坦克的右上和右下，是否侵入了其他坦克 anotherTank</span></span><br><span class="line">            <span class="keyword">return</span> anotherTank.isPointInTank(x + <span class="number">60</span>, y)</span><br><span class="line">                    || anotherTank.isPointInTank(x + <span class="number">60</span>, y + <span class="number">40</span>);</span><br><span class="line">        <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">            <span class="comment">// 本坦克向左移动，判断本坦克的左上和左下，是否侵入了其他坦克 anotherTank</span></span><br><span class="line">            <span class="keyword">return</span> anotherTank.isPointInTank(x, y)</span><br><span class="line">                    || anotherTank.isPointInTank(x, y + <span class="number">40</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;   <span class="comment">// 该 return 理论上不执行（除非异常）</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>3.</code> 也没有现成的函数，在实现函数之前，这里需要先好好考虑应该将函数实现放到哪。</p>
<ul>
<li><p>首先，明确该函数会在哪里调用：<strong>应该是在坦克的移动方法执行前调用</strong>。在进行坦克实际的移动之前，先检查目前坦克朝向的两个顶点，是否侵入了其他所有坦克中的某一个的矩形内部。<br>如果是在坦克的所有移动方法内部调用，因为坦克的所有移动方法，都是无形参的，这就给调用 <code>f3(tankA, otherTanks)</code> 带来了难题，<code>tankA</code> 尚能以 <code>this</code> 方式提供，但 <code>otherTanks</code> 去哪里获取？选择并不多：</p>
<ul>
<li>给坦克的移动方法加上形参 <code>otherTanks</code></li>
<li>将 <code>otherTanks</code> 设置为一个类内成员</li>
</ul>
<p>两种方式都不怎么优雅，这里选择和老韩保持一致（<strong>第二种：设置为类内成员</strong>）</p>
<p>当然也可以在坦克的所有移动方法的外部使用，这样虽然不需要考虑移动方法的形参的问题，但在外部，需要在所有用到移动方法的前面都加上该函数的调用，也不怎么优雅。</p>
</li>
<li><p>我的实现会扩展到将玩家坦克也实现防止重叠，对于玩家坦克 <code>otherTanks</code> 就是所有电脑坦克，对于电脑坦克 <code>otherTanks</code> 就是不包括自己的电脑坦克再加上玩家坦克<br>既然玩家坦克和电脑坦克的比较对象存在差异，该函数就应该实现两个版本放到 <code>Hero</code> 和 <code>EnemyTank</code> 中。</p>
</li>
</ul>
<p><code>Hero</code> 类版本的实现：</p>
<ul>
<li><p>首先给 <code>Hero</code> 添加一个成员 <code>otherTanks</code> 及其 setter 方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> Vector&lt;EnemyTank&gt; otherTanks = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setOtherTanks</span><span class="params">(Vector&lt;EnemyTank&gt; otherTanks)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.otherTanks = otherTanks;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>实现防止重叠的检查</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isTouchOtherTanks</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; otherTanks.size(); i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (isTouchAnotherTank(otherTanks.get(i))) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>重写 <code>Tank</code> 父类的移动方法，加上防止重叠的检查</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">moveUp</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (isTouchOtherTanks()) <span class="keyword">return</span>;</span><br><span class="line">    <span class="built_in">super</span>.moveUp();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">moveRight</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (isTouchOtherTanks()) <span class="keyword">return</span>;</span><br><span class="line">    <span class="built_in">super</span>.moveRight();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">moveDown</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (isTouchOtherTanks()) <span class="keyword">return</span>;</span><br><span class="line">    <span class="built_in">super</span>.moveDown();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">moveLeft</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (isTouchOtherTanks()) <span class="keyword">return</span>;</span><br><span class="line">    <span class="built_in">super</span>.moveLeft();</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><code>EnemyTank</code> 类版本的实现：</p>
<ul>
<li><p>首先给 <code>EnemyTank</code> 添加成员 <code>otherTanks</code> 和 <code>hero</code> 及其 setter 方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> Vector&lt;EnemyTank&gt; otherTanks = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="type">Hero</span> <span class="variable">hero</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setOtherTanks</span><span class="params">(Vector&lt;EnemyTank&gt; otherTanks)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.otherTanks = otherTanks;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setHero</span><span class="params">(Hero hero)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.hero = hero;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>实现防止重叠的检查</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isTouchOtherTanks</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (isTouchAnotherTank(hero)) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; otherTanks.size(); i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span> == otherTanks.get(i)) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">if</span> (isTouchAnotherTank(otherTanks.get(i))) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>重写 <code>Tank</code> 父类的移动方法，加上防止重叠的检查</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">moveUp</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (isTouchOtherTanks()) <span class="keyword">return</span>;</span><br><span class="line">    <span class="built_in">super</span>.moveUp();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">moveRight</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (isTouchOtherTanks()) <span class="keyword">return</span>;</span><br><span class="line">    <span class="built_in">super</span>.moveRight();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">moveDown</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (isTouchOtherTanks()) <span class="keyword">return</span>;</span><br><span class="line">    <span class="built_in">super</span>.moveDown();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">moveLeft</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (isTouchOtherTanks()) <span class="keyword">return</span>;</span><br><span class="line">    <span class="built_in">super</span>.moveLeft();</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>目前，防止敌人坦克重叠的功能已经完成，但还有可以改进的地方。</p>
<p>在 <code>Hero</code> 和 <code>EnemyTank</code> 类中，都需要重写移动方法 <code>moveXXX</code>，而且两个类中重写的移动方法内容是一样的，显然我们应该<strong>把重写后的移动方法逻辑提到父类中去</strong>。<br>为此我们就必须在父类中也定义 <code>isTouchOtherTanks</code> 方法，当然按照继承的思想，该方法是子类的共有方法，应该提到父类中，该方法在父类中可以没有具体实现，甚至可以做成抽象方法，让运行时动态绑定到 <code>Hero</code> 和 <code>EnemyTank</code> 重写的 <code>isTouchOtherTanks</code> 方法即可。</p>
<p>所以，现在按照继承的思路来进行代码结构的调整。在 <code>Hero</code> 和 <code>EnemyTank</code> 类中，共有的属性是 <code>otherTanks</code>，共有的方法是 <code>isTouchOtherTanks</code>，我们将它们都提到父类中去。</p>
<p><code>otherTanks</code> 的类型是 <code>Vector&lt;EnemyTank&gt;</code>，在父类定义含有子类类型的变量似乎不太好，换成 <code>Vector&lt;Tank&gt;</code> 似乎更好一点，但这又会遇到另外一个问题，就是泛型不具备继承的特性：无法将 <code>Vector&lt;EnemyTank&gt;</code> 赋值给 <code>Vector&lt;Tank&gt;</code>，为此，我们需要将所有 <code>Vector&lt;EnemyTank&gt;</code> 的地方都改成 <code>Vector&lt;Tank&gt;</code>。</p>
<p>先从 <code>Tank</code> 类开始：</p>
<ul>
<li>增加 <code>otherTanks</code> 属性和相应的 setter 和 getter 方法</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> Vector&lt;Tank&gt; otherTanks = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">public</span> Vector&lt;Tank&gt; <span class="title function_">getOtherTanks</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> otherTanks;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setOtherTanks</span><span class="params">(Vector&lt;Tank&gt; otherTanks)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.otherTanks = otherTanks;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>在 <code>Tank</code> 类中定义抽象方法 <code>isTouchOtherTanks</code>，将类改为抽象类</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Tank</span> &#123;</span><br><span class="line">    <span class="comment">// 省略其他代码</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 判断本坦克朝向的两个顶点，是否侵入了其他所有坦克中某个坦克对应的矩形内部</span></span><br><span class="line"><span class="comment">     * 留给子类重写</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="type">boolean</span> <span class="title function_">isTouchOtherTanks</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>修改 <code>Tank</code> 类中的移动方法逻辑，加入防重叠检查</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 坦克上右下左移动方法</span></span><br><span class="line"><span class="comment">// 在坦克上右下左移动方法中，加入对边界情况的限制！加入防重叠检查！</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">moveUp</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (isTouchOtherTanks()) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span> (y - speed &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        y -= speed;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        y = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">moveRight</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (isTouchOtherTanks()) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span> (x + <span class="number">60</span> + speed &lt; MyPanel.WIDTH) &#123;</span><br><span class="line">        x += speed;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        x = MyPanel.WIDTH - <span class="number">60</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">moveDown</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (isTouchOtherTanks()) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span> (y + <span class="number">60</span> + speed &lt; MyPanel.HEIGHT) &#123;</span><br><span class="line">        y += speed;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        y = MyPanel.HEIGHT - <span class="number">60</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">moveLeft</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (isTouchOtherTanks()) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span> (x - speed &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        x -= speed;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        x = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>回过头来修改 <code>Hero</code> 和 <code>EnemyTank</code> 子类，先是 <code>Hero</code>：</p>
<ul>
<li>移除 <code>otherTanks</code> 属性和及其 setter 方法，且移除所有重写的移动方法</li>
<li>重写 <code>isTouchOtherTanks</code> 方法<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isTouchOtherTanks</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; getOtherTanks().size(); i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (isTouchAnotherTank(getOtherTanks().get(i))) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>再是 <code>EnemyTank</code>：</p>
<ul>
<li>移除 <code>otherTanks</code> 属性和及其 setter 方法，且移除所有重写的移动方法</li>
<li>重写 <code>isTouchOtherTanks</code> 方法<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isTouchOtherTanks</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (isTouchAnotherTank(hero)) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; getOtherTanks().size(); i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span> == getOtherTanks().get(i)) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">if</span> (isTouchAnotherTank(getOtherTanks().get(i))) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>由于泛型不具有继承性，无法将 <code>Vector&lt;EnemyTank&gt;</code> 赋值给 <code>Vector&lt;Tank&gt;</code>，所以 <code>MyPanel</code> 中的代码也需要修改：</p>
<ul>
<li><p>将 <code>enemyTanks</code> 属性的类型从 <code>Vector&lt;EnemyTank&gt;</code> 改为 <code>Vector&lt;Tank&gt;</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> Vector&lt;Tank&gt; enemyTanks = <span class="keyword">new</span> <span class="title class_">Vector</span>&lt;&gt;();</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>enemyTanks</code> 的属性改变后，从中取出元素的编译类型就变为了 <code>Tank</code>，因此后续一些代码也需要略作修改：</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// paint 方法中</span></span><br><span class="line"><span class="comment">// EnemyTank enemyTank = enemyTanks.get(i); // old</span></span><br><span class="line"><span class="type">EnemyTank</span> <span class="variable">enemyTank</span> <span class="operator">=</span> (EnemyTank) enemyTanks.get(i); <span class="comment">// new</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// checkHeroShotEnemy 方法中</span></span><br><span class="line"><span class="comment">// EnemyTank enemyTank = enemyTanks.get(j); // old</span></span><br><span class="line"><span class="type">EnemyTank</span> <span class="variable">enemyTank</span> <span class="operator">=</span> (EnemyTank) enemyTanks.get(j); <span class="comment">// new</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// checkEnemyShotHero 方法中</span></span><br><span class="line"><span class="comment">// EnemyTank enemyTank = enemyTanks.get(i); // old</span></span><br><span class="line"><span class="type">EnemyTank</span> <span class="variable">enemyTank</span> <span class="operator">=</span> (EnemyTank) enemyTanks.get(i); <span class="comment">// new</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>其实 <code>Hero</code> 和 <code>EnemyTank</code> 中的 <code>shots</code> 属性及其 getter 方法，也可以再提到父类 <code>Tank</code> 中去，这里就不做改动</p>
<h3 id="一个隐藏的坑（坦克撞到空气墙）"><a href="#一个隐藏的坑（坦克撞到空气墙）" class="headerlink" title="一个隐藏的坑（坦克撞到空气墙）"></a>一个隐藏的坑（坦克撞到空气墙）</h3><p>老韩的实现中还隐藏了一个 Bug，即<strong>坦克撞到空气墙</strong>，复现该 Bug 步骤是：先让玩家坦克被击毁（死亡），此时游戏区域上玩家坦克已经爆炸消失，但此时电脑坦克移动到玩家坦克爆炸的地点，会像撞到空气墙一样停下。</p>
<p>该 Bug 的原因不难确定：在进行防重叠检查时，即使 <code>Hero</code> 对象已经死亡，但还是会将其纳入检查范围内，也即电脑坦克会检查自己是否侵入已死亡的 <code>Hero</code> 对象的矩形内部。</p>
<p>另外，在我的实现中，坦克死亡了，其子弹仍然会被绘制（而不是直接不去绘制）。<br>为了实现这一点，<strong>已经死亡的电脑坦克并不会立刻从 <code>MyPanel</code> 类的 <code>enemyTanks</code> 中移除，所以坦克撞到空气墙的现象，在我的版本里面会更加的频繁</strong>。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 绘制电脑坦克和每个坦克的相应子弹</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; enemyTanks.size(); ) &#123;</span><br><span class="line">    <span class="type">EnemyTank</span> <span class="variable">enemyTank</span> <span class="operator">=</span> (EnemyTank) enemyTanks.get(i);</span><br><span class="line">    <span class="keyword">if</span> (enemyTank.isAlive()) &#123;</span><br><span class="line">        drawTank(enemyTank, g);</span><br><span class="line">        i++;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 仅当电脑坦克的子弹也都死亡后，才将已死亡的电脑坦克移除（！！！）</span></span><br><span class="line">        <span class="keyword">if</span> (enemyTank.getShots().size() == <span class="number">0</span>) &#123;</span><br><span class="line">            enemyTanks.remove(enemyTank);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 电脑坦克死亡，其已经发射的子弹依然存活，需要进行绘制</span></span><br><span class="line">    Vector&lt;Shot&gt; shots = enemyTank.getShots();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; shots.size(); ) &#123;</span><br><span class="line">        <span class="type">Shot</span> <span class="variable">enemyShot</span> <span class="operator">=</span> shots.get(j);</span><br><span class="line">        <span class="keyword">if</span> (enemyShot.isAlive()) &#123;</span><br><span class="line">            drawShot(enemyShot, g);</span><br><span class="line">            j++;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            shots.remove(enemyShot);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>要解决空气墙 Bug，只需要对 <code>Tank</code> 中的 <code>isTouchAnotherTank</code> 略作修改即可：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 判断本坦克朝向的两个顶点，是否侵入其他坦克对应的矩形内部</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> anotherTank 其他坦克</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> 如果本坦克朝向的两个顶点都没有侵入其他坦克对应的矩形内部，返回 false， 否则返回 true</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isTouchAnotherTank</span><span class="params">(Tank anotherTank)</span> &#123;</span><br><span class="line">    <span class="comment">// 对于已经死亡的其他坦克，默认没有侵入</span></span><br><span class="line">    <span class="keyword">if</span> (!anotherTank.isAlive) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 把握好主体：本坦克（this）朝向的两个顶点是否侵入了其他坦克 anotherTank 的矩形内部</span></span><br><span class="line">    <span class="comment">// 本坦克朝向的两个顶点与本坦克的方向有关，因此这里 switch 中放入的是 this.direct</span></span><br><span class="line">    <span class="keyword">switch</span> (direct) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">            <span class="comment">// 本坦克向上移动，判断本坦克的左上和右上，是否侵入了其他坦克 anotherTank</span></span><br><span class="line">            <span class="keyword">return</span> anotherTank.isPointInTank(x, y)</span><br><span class="line">                    || anotherTank.isPointInTank(x + <span class="number">40</span>, y);</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">            <span class="comment">// 本坦克向下移动，判断本坦克的左下和右下，是否侵入了其他坦克 anotherTank</span></span><br><span class="line">            <span class="keyword">return</span> anotherTank.isPointInTank(x, y + <span class="number">60</span>)</span><br><span class="line">                    || anotherTank.isPointInTank(x + <span class="number">40</span>, y + <span class="number">60</span>);</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            <span class="comment">// 本坦克向右移动，判断本坦克的右上和右下，是否侵入了其他坦克 anotherTank</span></span><br><span class="line">            <span class="keyword">return</span> anotherTank.isPointInTank(x + <span class="number">60</span>, y)</span><br><span class="line">                    || anotherTank.isPointInTank(x + <span class="number">60</span>, y + <span class="number">40</span>);</span><br><span class="line">        <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">            <span class="comment">// 本坦克向左移动，判断本坦克的左上和左下，是否侵入了其他坦克 anotherTank</span></span><br><span class="line">            <span class="keyword">return</span> anotherTank.isPointInTank(x, y)</span><br><span class="line">                    || anotherTank.isPointInTank(x, y + <span class="number">40</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;   <span class="comment">// 该 return 理论上不执行（除非异常）</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="我的思路有哪些问题（记录我踩的一些坑）"><a href="#我的思路有哪些问题（记录我踩的一些坑）" class="headerlink" title="我的思路有哪些问题（记录我踩的一些坑）"></a>我的思路有哪些问题（记录我踩的一些坑）</h3><ol>
<li><p>认为如果两个坦克重叠，则任取其中一个坦克，其对应矩形的四个顶点，必然至少有一个落在另外一个坦克的对应矩形内部。<br>对于正方形来说是正确的，但对于长方形来说，这是不一定的。<br>可以想象一个两坦克摆出的十字架，显然这两个坦克是重叠的，但它们对应矩形的四个顶点都没有落在另外一个坦克的矩形内部</p>
</li>
<li><p>在认为重叠的判断中，将坦克的矩形的四个顶点都纳入判断条件，会造成坦克碰撞后的原地粘连的现象</p>
</li>
<li><p>没有弄清楚坦克重叠/碰撞后，到底应该限制谁的移动，也即在实现过程中只盯着防止重叠，却忽略了限制移动。<br>我的做法是，将重叠的两个坦克全部停止移动，这是不太合理的。</p>
</li>
<li><p>在写好了防止坦克重叠的方法后，没有弄清楚应该在哪里使用该方法，从而限制坦克的移动<br>我一开始的做法是，在 <code>Tank</code> 中设置 <code>canMove</code> 布尔属性，该属性会在坦克的移动方法中用到，然后在 <code>MyPanel</code> 的 <code>run</code> 方法中不断进行重叠检查，发生重叠后就将相应坦克的 <code>canMove</code> 布尔属性置为 <code>false</code>。<br>这样的做法是有一些问题的，<code>MyPanel</code> 的 <code>run</code> 方法是 100ms 执行一次，而 <code>EnemyTank</code> 的移动是 50ms 一次，<code>Hero</code> 中的移动更是和键盘输入有关（一般小于 50ms）。<br>假设 <code>EnemyTank</code> 移动后已经碰撞到其他坦克了，且因为 <code>canMove</code> 为 <code>true</code> 所以还可以继续移动，那么必须要等到 <code>MyPanel</code> 的 <code>run</code> 方法执行检查完将 <code>canMove</code> 设为 <code>false</code> 后才能真正限制其移动，这样 <code>EnemyTank</code> 会重叠得更深一点。<br>将 <code>MyPanel</code> 的 <code>run</code> 方法的执行周期降低到 50ms 以下可以解决这个问题，但不可否认的是，这种通过“中间商” <code>canMove</code> 间接控制的方式，不仅逻辑上不够直接，还会造成其他麻烦！<br>因此，还是像老韩那样，将重叠检查放到每个坦克类中，从而直接在调用移动方法时，进行防重叠检查来限制移动，更直接更明确。</p>
</li>
</ol>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://example.com">RQTN</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://example.com/hsp-javase/ch20-%E5%9D%A6%E5%85%8B%E5%A4%A7%E6%88%98%20-%20%E9%98%B2%E6%AD%A2%E6%95%8C%E4%BA%BA%E5%9D%A6%E5%85%8B%E9%87%8D%E5%8F%A0%E8%B8%A9%E5%9D%91%E8%AE%B0%E5%BD%95/">http://example.com/hsp-javase/ch20-%E5%9D%A6%E5%85%8B%E5%A4%A7%E6%88%98%20-%20%E9%98%B2%E6%AD%A2%E6%95%8C%E4%BA%BA%E5%9D%A6%E5%85%8B%E9%87%8D%E5%8F%A0%E8%B8%A9%E5%9D%91%E8%AE%B0%E5%BD%95/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">RQTN</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/hsp-javase/">hsp-javase</a><a class="post-meta__tags" href="/tags/%E5%9D%A6%E5%85%8B%E5%A4%A7%E6%88%98/">坦克大战</a></div><div class="post_share"></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/hsp-javase/ch04-%E5%8E%9F%E7%A0%81%E5%8F%8D%E7%A0%81%E4%B8%8E%E8%A1%A5%E7%A0%81/" title="原码反码与补码"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">原码反码与补码</div></div></a></div><div class="next-post pull-right"><a href="/hsp-javase/ch22-%E5%A4%9A%E7%94%A8%E6%88%B7%E9%80%9A%E4%BF%A1%E7%B3%BB%E7%BB%9F%20-%20Socket%20%E7%BC%96%E7%A8%8B%E4%BD%BF%E7%94%A8%E5%AF%B9%E8%B1%A1%E6%B5%81%E8%BF%9B%E8%A1%8C%E9%80%9A%E4%BF%A1%E7%9A%84%E8%B8%A9%E5%9D%91%E8%AE%B0%E5%BD%95/" title="多用户通信系统 - Socket 编程使用对象流进行通信的踩坑记录"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">多用户通信系统 - Socket 编程使用对象流进行通信的踩坑记录</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/hsp-javase/ch04-%E5%8E%9F%E7%A0%81%E5%8F%8D%E7%A0%81%E4%B8%8E%E8%A1%A5%E7%A0%81/" title="原码反码与补码"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-11</div><div class="title">原码反码与补码</div></div></a></div><div><a href="/hsp-javase/ch03-%E6%B5%AE%E7%82%B9%E6%95%B0%E4%BD%BF%E7%94%A8%E9%99%B7%E9%98%B1/" title="浮点数使用陷阱"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-09</div><div class="title">浮点数使用陷阱</div></div></a></div><div><a href="/hsp-javase/ch22-%E5%A4%9A%E7%94%A8%E6%88%B7%E9%80%9A%E4%BF%A1%E7%B3%BB%E7%BB%9F%20-%20Socket%20%E7%BC%96%E7%A8%8B%E4%BD%BF%E7%94%A8%E5%AF%B9%E8%B1%A1%E6%B5%81%E8%BF%9B%E8%A1%8C%E9%80%9A%E4%BF%A1%E7%9A%84%E8%B8%A9%E5%9D%91%E8%AE%B0%E5%BD%95/" title="多用户通信系统 - Socket 编程使用对象流进行通信的踩坑记录"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-28</div><div class="title">多用户通信系统 - Socket 编程使用对象流进行通信的踩坑记录</div></div></a></div><div><a href="/hsp-javase/ch24-MySQL%20%E6%9D%82%E8%AE%B0/" title="MySQL 杂记"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-09-01</div><div class="title">MySQL 杂记</div></div></a></div><div><a href="/hsp-javase/ch24-%E8%AF%BB%E5%8F%96%E7%8E%B0%E8%B1%A1%E5%92%8C%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB/" title="读取现象和隔离级别"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-30</div><div class="title">读取现象和隔离级别</div></div></a></div><div><a href="/hsp-javase/%E5%A5%BD%E6%96%87%E6%94%B6%E5%BD%95-%E6%9C%80%E7%86%9F%E6%82%89%E7%9A%84%E9%99%8C%E7%94%9F%E4%BA%BA%EF%BC%8C%E9%82%A3%E4%BA%9B%E5%85%B3%E4%BA%8EString%E4%BD%A0%E4%B8%8D%E5%BE%97%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84%E4%B8%9C%E8%A5%BF/" title="好文收录 - 最熟悉的陌生人，那些关于String你不得不知道的东西"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-09-01</div><div class="title">好文收录 - 最熟悉的陌生人，那些关于String你不得不知道的东西</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">RQTN</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">63</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">36</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">17</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/RQTN"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/RQTN" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9D%A6%E5%85%8B%E5%A4%A7%E6%88%98-%E9%98%B2%E6%AD%A2%E6%95%8C%E4%BA%BA%E5%9D%A6%E5%85%8B%E9%87%8D%E5%8F%A0-%E8%B8%A9%E5%9D%91%E8%AE%B0%E5%BD%95"><span class="toc-number">1.</span> <span class="toc-text">坦克大战 - 防止敌人坦克重叠 踩坑记录</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8%E7%82%B9%EF%BC%88%E7%9B%AE%E5%89%8D%E6%88%91%E7%9A%84%E5%9D%A6%E5%85%8B%E5%A4%A7%E6%88%98%E4%BB%A3%E7%A0%81%EF%BC%89"><span class="toc-number">1.1.</span> <span class="toc-text">启动点（目前我的坦克大战代码）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Tank-%E7%B1%BB%EF%BC%9A"><span class="toc-number">1.1.1.</span> <span class="toc-text">Tank 类：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#EnemyTank-%E7%B1%BB"><span class="toc-number">1.1.2.</span> <span class="toc-text">EnemyTank 类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Hero-%E7%B1%BB"><span class="toc-number">1.1.3.</span> <span class="toc-text">Hero 类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Shot-%E7%B1%BB"><span class="toc-number">1.1.4.</span> <span class="toc-text">Shot 类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Bomb-%E7%B1%BB"><span class="toc-number">1.1.5.</span> <span class="toc-text">Bomb 类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#MyPanel-%E7%B1%BB"><span class="toc-number">1.1.6.</span> <span class="toc-text">MyPanel 类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HspTankGame05-%E7%B1%BB"><span class="toc-number">1.1.7.</span> <span class="toc-text">HspTankGame05 类</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%80%81%E9%9F%A9%E7%9A%84%E6%80%9D%E8%B7%AF%E8%A7%A3%E6%9E%90"><span class="toc-number">1.2.</span> <span class="toc-text">老韩的思路解析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%80%81%E9%9F%A9%E7%9A%84%E6%80%9D%E8%B7%AF%E5%9C%A8%E6%88%91%E7%9A%84%E5%90%AF%E5%8A%A8%E7%82%B9%E4%B8%8A%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0"><span class="toc-number">1.3.</span> <span class="toc-text">老韩的思路在我的启动点上如何实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E4%B8%AA%E9%9A%90%E8%97%8F%E7%9A%84%E5%9D%91%EF%BC%88%E5%9D%A6%E5%85%8B%E6%92%9E%E5%88%B0%E7%A9%BA%E6%B0%94%E5%A2%99%EF%BC%89"><span class="toc-number">1.4.</span> <span class="toc-text">一个隐藏的坑（坦克撞到空气墙）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%88%91%E7%9A%84%E6%80%9D%E8%B7%AF%E6%9C%89%E5%93%AA%E4%BA%9B%E9%97%AE%E9%A2%98%EF%BC%88%E8%AE%B0%E5%BD%95%E6%88%91%E8%B8%A9%E7%9A%84%E4%B8%80%E4%BA%9B%E5%9D%91%EF%BC%89"><span class="toc-number">1.5.</span> <span class="toc-text">我的思路有哪些问题（记录我踩的一些坑）</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/itheima-mysql/MVCC%20-%20undo%20log%20%E7%89%88%E6%9C%AC%E9%93%BE%E6%95%B0%E6%8D%AE%E8%AE%BF%E9%97%AE%E8%A7%84%E5%88%99/" title="MVCC - undo log 版本链数据访问规则">MVCC - undo log 版本链数据访问规则</a><time datetime="2023-06-27T14:19:24.000Z" title="发表于 2023-06-27 22:19:24">2023-06-27</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/itheima-juc/synchronized%20%E5%8E%9F%E7%90%86/" title="synchronized 原理">synchronized 原理</a><time datetime="2023-05-04T09:46:08.000Z" title="发表于 2023-05-04 17:46:08">2023-05-04</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/itheima-juc/%E5%A5%BD%E6%96%87%E6%94%B6%E5%BD%95-%E6%AD%BB%E7%A3%95Synchronized%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0--%E9%87%8D%E9%87%8F%E7%BA%A7%E9%94%81/" title="好文收录 - 死磕Synchronized底层实现--重量级锁">好文收录 - 死磕Synchronized底层实现--重量级锁</a><time datetime="2023-04-27T17:00:08.000Z" title="发表于 2023-04-28 01:00:08">2023-04-28</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/itheima-juc/%E5%A5%BD%E6%96%87%E6%94%B6%E5%BD%95-%E6%AD%BB%E7%A3%95Synchronized%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0--%E8%BD%BB%E9%87%8F%E7%BA%A7%E9%94%81/" title="好文收录 - 死磕Synchronized底层实现--轻量级锁">好文收录 - 死磕Synchronized底层实现--轻量级锁</a><time datetime="2023-04-26T17:00:08.000Z" title="发表于 2023-04-27 01:00:08">2023-04-27</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/itheima-juc/%E5%A5%BD%E6%96%87%E6%94%B6%E5%BD%95-%E6%AD%BB%E7%A3%95Synchronized%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0--%E5%81%8F%E5%90%91%E9%94%81/" title="好文收录 - 死磕Synchronized底层实现--偏向锁">好文收录 - 死磕Synchronized底层实现--偏向锁</a><time datetime="2023-04-25T17:00:08.000Z" title="发表于 2023-04-26 01:00:08">2023-04-26</time></div></div></div></div></div></div></main><footer id="footer" style="background: linear-gradient(20deg, #0062be, #925696, #cc426e, #fb0347)"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2024 By RQTN</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://unpkg.com/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.js"></script><div class="js-pjax"></div><script defer="defer" id="ribbon" src="https://unpkg.com/butterfly-extsrc@1.1.3/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="true"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>